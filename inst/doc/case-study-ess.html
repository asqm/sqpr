<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jorge Cimentada and Wiebke Weber" />

<meta name="date" content="2018-03-21" />

<title>Case-study: Correcting for measurement error in the European Social Survey</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Case-study: Correcting for measurement error in the European Social Survey</h1>
<h4 class="author"><em>Jorge Cimentada and Wiebke Weber</em></h4>
<h4 class="date"><em>2018-03-21</em></h4>



<p>In this case study we will go through an applied example of the capabilities of the <code>sqpr</code> package. For a detailed example on accessing the SQP API, check out the ‘Accessing the SQP API’ vignette from the <code>sqpr</code> package.</p>
<p>We’ll begin by loading the packages we’ll use and the <code>sqpr</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;lavaan&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ess&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;sqpr&quot;</span>)</code></pre></div>
<div id="read-the-data" class="section level2">
<h2>Read the data</h2>
<p>Let’s read in the data from the European Social Survey using the <code>ess</code> package and create a sum score of a number of variables. A sum score is literally the <code>sum</code> of a number of variables to create a composite score. Remember to replace your email in the argument <code>your_email</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ess7es&lt;-
<span class="st">  </span><span class="kw">ess_country</span>(<span class="st">&quot;Spain&quot;</span>, <span class="dv">7</span>, your_email) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">recode_missings</span>() 

<span class="co"># Create composite scores</span>
ess7es &lt;-
<span class="st">  </span>ess7es <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">poltrst =</span> trstprl <span class="op">+</span><span class="st"> </span>trstplt <span class="op">+</span><span class="st"> </span>trstprt,
         <span class="dt">serv =</span> stfedu <span class="op">+</span><span class="st"> </span>stfhlth,
         <span class="dt">systmrsp =</span> psppsgv <span class="op">+</span><span class="st"> </span>psppipl <span class="op">+</span><span class="st"> </span>ptcpplt)

selected_vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;trstprl&quot;</span>, <span class="st">&quot;trstplt&quot;</span>, <span class="st">&quot;trstprt&quot;</span>,
                   <span class="st">&quot;stfedu&quot;</span>, <span class="st">&quot;stfhlth&quot;</span>, <span class="st">&quot;psppsgv&quot;</span>,
                   <span class="st">&quot;psppipl&quot;</span>, <span class="st">&quot;ptcpplt&quot;</span>, <span class="st">&quot;ppltrst&quot;</span>,
                   <span class="st">&quot;polintr&quot;</span>, <span class="st">&quot;stflife&quot;</span>, <span class="st">&quot;stfeco&quot;</span>,
                   <span class="st">&quot;agea&quot;</span>,<span class="st">&quot;eisced&quot;</span>)

composite_scores &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;poltrst&quot;</span>, <span class="st">&quot;serv&quot;</span>, <span class="st">&quot;systmrsp&quot;</span>)

all_vars &lt;-<span class="st"> </span><span class="kw">c</span>(composite_scores, selected_vars) <span class="co"># for using later</span></code></pre></div>
<p>So far we the original <code>tibble</code> with a few extra columns containing the composite sum scores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ess7es
<span class="co">#&gt; # A tibble: 1,925 x 604</span>
<span class="co">#&gt;    name  essround edition proddate  idno cntry tvtot tvpol ppltrst pplfair</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl+l&gt; &lt;dbl+l&gt;</span>
<span class="co">#&gt;  1 ESS7~       7. 2.1     01.12.2~    1. ES    2     2     6       6      </span>
<span class="co">#&gt;  2 ESS7~       7. 2.1     01.12.2~    3. ES    2     2     6       6      </span>
<span class="co">#&gt;  3 ESS7~       7. 2.1     01.12.2~    4. ES    3     3     6       5      </span>
<span class="co">#&gt;  4 ESS7~       7. 2.1     01.12.2~    5. ES    2     1     7       7      </span>
<span class="co">#&gt;  5 ESS7~       7. 2.1     01.12.2~    6. ES    5     4     10      10     </span>
<span class="co">#&gt;  6 ESS7~       7. 2.1     01.12.2~    7. ES    7     2     7       5      </span>
<span class="co">#&gt;  7 ESS7~       7. 2.1     01.12.2~    8. ES    7     7     2       8      </span>
<span class="co">#&gt;  8 ESS7~       7. 2.1     01.12.2~   10. ES    6     5     2       8      </span>
<span class="co">#&gt;  9 ESS7~       7. 2.1     01.12.2~   12. ES    0     &lt;NA&gt;  5       7      </span>
<span class="co">#&gt; 10 ESS7~       7. 2.1     01.12.2~   14. ES    3     1     3       3      </span>
<span class="co">#&gt; # ... with 1,915 more rows, and 594 more variables: pplhlp &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   polintr &lt;dbl+lbl&gt;, psppsgv &lt;dbl+lbl&gt;, actrolg &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   psppipl &lt;dbl+lbl&gt;, cptppol &lt;dbl+lbl&gt;, ptcpplt &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   etapapl &lt;dbl+lbl&gt;, trstprl &lt;dbl+lbl&gt;, trstlgl &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   trstplc &lt;dbl+lbl&gt;, trstplt &lt;dbl+lbl&gt;, trstprt &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   trstep &lt;dbl+lbl&gt;, trstun &lt;dbl+lbl&gt;, vote &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtvtbat &lt;dbl+lbl&gt;, prtvtcbe &lt;dbl+lbl&gt;, prtvtech &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtvtdcz &lt;dbl+lbl&gt;, prtvede1 &lt;dbl+lbl&gt;, prtvede2 &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtvtcdk &lt;dbl+lbl&gt;, prtvteee &lt;dbl+lbl&gt;, prtvtces &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtvtcfi &lt;dbl+lbl&gt;, prtvtcfr &lt;dbl+lbl&gt;, prtvtbgb &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtvtehu &lt;dbl+lbl&gt;, prtvtaie &lt;dbl+lbl&gt;, prtvtcil &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtvalt1 &lt;dbl+lbl&gt;, prtvalt2 &lt;dbl+lbl&gt;, prtvalt3 &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtvtfnl &lt;dbl+lbl&gt;, prtvtbno &lt;dbl+lbl&gt;, prtvtcpl &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtvtbpt &lt;dbl+lbl&gt;, prtvtbse &lt;dbl+lbl&gt;, prtvtesi &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   contplt &lt;dbl+lbl&gt;, wrkprty &lt;dbl+lbl&gt;, wrkorg &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   badge &lt;dbl+lbl&gt;, sgnptit &lt;dbl+lbl&gt;, pbldmn &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   bctprd &lt;dbl+lbl&gt;, clsprty &lt;dbl+lbl&gt;, prtclcat &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtclcbe &lt;dbl+lbl&gt;, prtclech &lt;dbl+lbl&gt;, prtcldcz &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtclede &lt;dbl+lbl&gt;, prtclcdk &lt;dbl+lbl&gt;, prtcleee &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtcldes &lt;dbl+lbl&gt;, prtclcfi &lt;dbl+lbl&gt;, prtclcfr &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtclbgb &lt;dbl+lbl&gt;, prtclehu &lt;dbl+lbl&gt;, prtclaie &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtcldil &lt;dbl+lbl&gt;, prtclalt &lt;dbl+lbl&gt;, prtclenl &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtclbno &lt;dbl+lbl&gt;, prtclfpl &lt;dbl+lbl&gt;, prtcldpt &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   prtclbse &lt;dbl+lbl&gt;, prtclesi &lt;dbl+lbl&gt;, prtdgcl &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   lrscale &lt;dbl+lbl&gt;, stflife &lt;dbl+lbl&gt;, stfeco &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   stfgov &lt;dbl+lbl&gt;, stfdem &lt;dbl+lbl&gt;, stfedu &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   stfhlth &lt;dbl+lbl&gt;, gincdif &lt;dbl+lbl&gt;, freehms &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   euftf &lt;dbl+lbl&gt;, imsmetn &lt;dbl+lbl&gt;, imdfetn &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   eimpcnt &lt;dbl+lbl&gt;, impcntr &lt;dbl+lbl&gt;, imbgeco &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   imueclt &lt;dbl+lbl&gt;, imwbcnt &lt;dbl+lbl&gt;, happy &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   sclmeet &lt;dbl+lbl&gt;, inprdsc &lt;dbl+lbl&gt;, sclact &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   crmvct &lt;dbl+lbl&gt;, aesfdrk &lt;dbl+lbl&gt;, health &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   hlthhmp &lt;dbl+lbl&gt;, rlgblg &lt;dbl+lbl&gt;, rlgdnm &lt;dbl+lbl&gt;,</span>
<span class="co">#&gt; #   rlgdnbat &lt;dbl+lbl&gt;, rlgdnbe &lt;dbl+lbl&gt;, rlgdnach &lt;dbl+lbl&gt;, ...</span></code></pre></div>
<p>Let’s read in the SQP data. First we login with <code>sqp_login()</code> and for that to work we need to execute these two lines with our valid SQP credentials:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Sys.setenv</span>(<span class="dt">SQP_USER =</span> <span class="st">'your_username'</span>)
<span class="kw">Sys.setenv</span>(<span class="dt">SQP_PW =</span> <span class="st">'your_pw'</span>)</code></pre></div>
<p>Once that’s done, we can run <code>sqp_login()</code> and continue with accessing the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqp_login</span>()
study_id &lt;-<span class="st"> </span><span class="kw">find_studies</span>(<span class="st">&quot;ESS Round 7&quot;</span>)<span class="op">$</span>id

questions &lt;-
<span class="st">  </span>study_id <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">find_questions</span>(selected_vars[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>]) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(country_iso <span class="op">==</span><span class="st"> &quot;ES&quot;</span>, language_iso <span class="op">==</span><span class="st"> &quot;spa&quot;</span>)</code></pre></div>
<p>Let’s confirm all of our questions were extracted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all</span>(<span class="kw">tolower</span>(questions<span class="op">$</span>short_name) <span class="op">%in%</span><span class="st"> </span>selected_vars[<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>])
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Why are we only selecting 12 variables? You’ll see later on. We will add the predicted estimates of the last two manually because they’re not in the SQP data base.</p>
<p>To wrap the SQP API related business, let’s grab the predicted estimates with <code>get_estimates</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sqp_data &lt;-
<span class="st">  </span><span class="kw">get_estimates</span>(questions<span class="op">$</span>id) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(question)</code></pre></div>
<p>Alright, now we have a nicely formatted <code>tibble</code> from the SQP database in R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sqp_data
<span class="co">#&gt; # A tibble: 12 x 4</span>
<span class="co">#&gt;    question reliability validity quality</span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 polintr        0.624    0.964   0.601</span>
<span class="co">#&gt;  2 ppltrst        0.737    0.954   0.703</span>
<span class="co">#&gt;  3 psppipl        0.762    0.928   0.707</span>
<span class="co">#&gt;  4 psppsgv        0.766    0.927   0.709</span>
<span class="co">#&gt;  5 ptcpplt        0.766    0.928   0.711</span>
<span class="co">#&gt;  6 stfeco         0.797    0.912   0.727</span>
<span class="co">#&gt;  7 stfedu         0.757    0.838   0.635</span>
<span class="co">#&gt;  8 stfhlth        0.760    0.798   0.607</span>
<span class="co">#&gt;  9 stflife        0.721    0.911   0.657</span>
<span class="co">#&gt; 10 trstplt        0.852    0.965   0.822</span>
<span class="co">#&gt; 11 trstprl        0.812    0.959   0.779</span>
<span class="co">#&gt; 12 trstprt        0.858    0.956   0.821</span></code></pre></div>
</div>
<div id="analysis" class="section level2">
<h2>Analysis</h2>
<p>With the function <code>sqpr_sscore</code> we can calculate the quality of a sum score. Remember those sum scores we calculated at the beginning? We can calculate the quality of the sum score by specifying the data from the SQP API, the data from the European Social Survey and provide <code>sqp_sscore</code> with the variables that contribute to the sum score.</p>
<p>For example, this code..</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqp_sscore</span>(<span class="dt">sqp_data =</span> sqp_data,
           <span class="dt">df =</span> ess7es,
           <span class="dt">new_name =</span> poltrst,
           trstprl, trstplt, trstprt)
<span class="co">#&gt; # A tibble: 10 x 4</span>
<span class="co">#&gt;    question reliability validity quality</span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 polintr        0.624    0.964   0.601</span>
<span class="co">#&gt;  2 ppltrst        0.737    0.954   0.703</span>
<span class="co">#&gt;  3 psppipl        0.762    0.928   0.707</span>
<span class="co">#&gt;  4 psppsgv        0.766    0.927   0.709</span>
<span class="co">#&gt;  5 ptcpplt        0.766    0.928   0.711</span>
<span class="co">#&gt;  6 stfeco         0.797    0.912   0.727</span>
<span class="co">#&gt;  7 stfedu         0.757    0.838   0.635</span>
<span class="co">#&gt;  8 stfhlth        0.760    0.798   0.607</span>
<span class="co">#&gt;  9 stflife        0.721    0.911   0.657</span>
<span class="co">#&gt; 10 poltrst       NA       NA       0.913</span></code></pre></div>
<p>creates a new variable called <code>poltrst</code> which will have the quality of the sum score of <code>trstprl</code>, <code>trstplt</code>, <code>trstprt</code>. Note that these three variables are <strong>not</strong> present anymore, but only <code>poltrst</code>, the summary of the three. For our analysis we want to repeat that for the three sum scores from the beginning. Let’s extend it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Quality &lt;-
<span class="st">  </span>sqp_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">sqp_sscore</span>(<span class="dt">df =</span> ess7es, <span class="dt">new_name =</span> poltrst, trstprl, trstplt, trstprt) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">sqp_sscore</span>(<span class="dt">df =</span> ess7es, <span class="dt">new_name =</span> serv, stfedu, stfhlth) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">sqp_sscore</span>(<span class="dt">df =</span> ess7es, <span class="dt">new_name =</span> systmrsp, psppsgv, psppipl, ptcpplt) </code></pre></div>
<p>Let’s see how it looks like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Quality
<span class="co">#&gt; # A tibble: 7 x 4</span>
<span class="co">#&gt;   question reliability validity quality</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 polintr        0.624    0.964   0.601</span>
<span class="co">#&gt; 2 ppltrst        0.737    0.954   0.703</span>
<span class="co">#&gt; 3 stfeco         0.797    0.912   0.727</span>
<span class="co">#&gt; 4 stflife        0.721    0.911   0.657</span>
<span class="co">#&gt; 5 poltrst       NA       NA       0.913</span>
<span class="co">#&gt; 6 serv          NA       NA       0.748</span>
<span class="co">#&gt; 7 systmrsp      NA       NA       0.841</span></code></pre></div>
<p>Great! We have our summarized <code>tibble</code>. Sometimes you’ll want to manually append predictions such as quality estimates not available in the SQP API. For our case, we want to add the <code>quality</code> estimates of the variables <code>agea</code> and <code>eised</code> (remember those two we were excluding from before? we were excluding them because they’re not available in the SQP data base). For that we can use <code>sqp_bind_metrics</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Quality &lt;-<span class="st"> </span>
<span class="st">  </span>Quality <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">sqp_bind_metrics</span>(agea, <span class="kw">list</span>(<span class="dt">quality =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">sqp_bind_metrics</span>(eisced, <span class="kw">list</span>(<span class="dt">quality =</span> <span class="fl">0.93</span>))

Quality
<span class="co">#&gt; # A tibble: 9 x 4</span>
<span class="co">#&gt;   question reliability validity quality</span>
<span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 polintr        0.624    0.964   0.601</span>
<span class="co">#&gt; 2 ppltrst        0.737    0.954   0.703</span>
<span class="co">#&gt; 3 stfeco         0.797    0.912   0.727</span>
<span class="co">#&gt; 4 stflife        0.721    0.911   0.657</span>
<span class="co">#&gt; 5 poltrst       NA       NA       0.913</span>
<span class="co">#&gt; 6 serv          NA       NA       0.748</span>
<span class="co">#&gt; 7 systmrsp      NA       NA       0.841</span>
<span class="co">#&gt; 8 agea          NA       NA       1.00 </span>
<span class="co">#&gt; 9 eisced        NA       NA       0.930</span></code></pre></div>
<p>Note that <code>sqp_bind_metrics</code> is very strict, it accepts an <code>sqp</code> data frame (given by <code>get_estimates</code>) and it will match that the names of your estimates (<code>quality</code> here) matches exactly the same names in the SQP API. You can read more about it in <code>?sqp_bind_metrics</code>. Finally, let’s order our results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">variables_order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;poltrst&quot;</span>,
                     <span class="st">&quot;serv&quot;</span>,
                     <span class="st">&quot;systmrsp&quot;</span>,
                     <span class="st">&quot;ppltrst&quot;</span>,
                     <span class="st">&quot;polintr&quot;</span>,
                     <span class="st">&quot;stflife&quot;</span>,
                     <span class="st">&quot;stfeco&quot;</span>,
                     <span class="st">&quot;agea&quot;</span>,
                     <span class="st">&quot;eisced&quot;</span>)

Quality &lt;-<span class="st"> </span>Quality[<span class="kw">match</span>(variables_order, Quality<span class="op">$</span>question), ]</code></pre></div>
<p>Briefly, let’s also select these variables for ESS data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ess7escorr &lt;-<span class="st"> </span>ess7es <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(variables_order)</code></pre></div>
</div>
<div id="correlations-and-correcting-for-measurement-error" class="section level2">
<h2>Correlations and correcting for measurement error</h2>
<p>Let’s get the correlation of all the variables in the ESS data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Exploratory correlation matrix (in order of the columns in data frame):</span>
original_corr_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cor</span>(ess7escorr, <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)

original_corr_<span class="dv">2</span>
<span class="co">#&gt;              poltrst        serv    systmrsp     ppltrst       polintr</span>
<span class="co">#&gt; poltrst   1.00000000  0.42234347  0.60017274  0.18756402 -0.1998034262</span>
<span class="co">#&gt; serv      0.42234347  1.00000000  0.31451487  0.11161757 -0.0238949765</span>
<span class="co">#&gt; systmrsp  0.60017274  0.31451487  1.00000000  0.17976483 -0.2340428111</span>
<span class="co">#&gt; ppltrst   0.18756402  0.11161757  0.17976483  1.00000000 -0.1987630767</span>
<span class="co">#&gt; polintr  -0.19980343 -0.02389498 -0.23404281 -0.19876308  1.0000000000</span>
<span class="co">#&gt; stflife   0.13809045  0.18105357  0.14334382  0.14719373 -0.0407515829</span>
<span class="co">#&gt; stfeco    0.43680221  0.38492773  0.34387670  0.09057548 -0.1050462717</span>
<span class="co">#&gt; agea      0.03343543  0.01723621  0.01364820 -0.05888371  0.0002020306</span>
<span class="co">#&gt; eisced   -0.01546372 -0.05567295  0.05062386  0.16991291 -0.3124573975</span>
<span class="co">#&gt;              stflife      stfeco          agea      eisced</span>
<span class="co">#&gt; poltrst   0.13809045  0.43680221  0.0334354262 -0.01546372</span>
<span class="co">#&gt; serv      0.18105357  0.38492773  0.0172362098 -0.05567295</span>
<span class="co">#&gt; systmrsp  0.14334382  0.34387670  0.0136482010  0.05062386</span>
<span class="co">#&gt; ppltrst   0.14719373  0.09057548 -0.0588837086  0.16991291</span>
<span class="co">#&gt; polintr  -0.04075158 -0.10504627  0.0002020306 -0.31245740</span>
<span class="co">#&gt; stflife   1.00000000  0.27002646 -0.0375443228  0.07276395</span>
<span class="co">#&gt; stfeco    0.27002646  1.00000000  0.0165999850  0.03815190</span>
<span class="co">#&gt; agea     -0.03754432  0.01659999  1.0000000000 -0.22553987</span>
<span class="co">#&gt; eisced    0.07276395  0.03815190 -0.2255398662  1.00000000</span></code></pre></div>
<p><code>sqpr</code> has a very similar function to <code>cor</code> but allows to replace the diagonal. In our analysis we can use it to replace the diagonal with the quality estimates of all the variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corr_q2 &lt;-
<span class="st">  </span><span class="kw">sqp_correlate</span>(<span class="dt">x =</span> ess7escorr,
                <span class="dt">diag_adj =</span> Quality<span class="op">$</span>quality,
                <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>,
                <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)

corr_q2
<span class="co">#&gt; # A tibble: 9 x 10</span>
<span class="co">#&gt;   rowname  poltrst    serv systmrsp ppltrst   polintr stflife  stfeco</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 poltrst   0.913   0.422    0.600   0.188  -0.200     0.138   0.437 </span>
<span class="co">#&gt; 2 serv      0.422   0.748    0.315   0.112  -0.0239    0.181   0.385 </span>
<span class="co">#&gt; 3 systmrsp  0.600   0.315    0.841   0.180  -0.234     0.143   0.344 </span>
<span class="co">#&gt; 4 ppltrst   0.188   0.112    0.180   0.703  -0.199     0.147   0.0906</span>
<span class="co">#&gt; 5 polintr  -0.200  -0.0239  -0.234  -0.199   0.601    -0.0408 -0.105 </span>
<span class="co">#&gt; 6 stflife   0.138   0.181    0.143   0.147  -0.0408    0.657   0.270 </span>
<span class="co">#&gt; 7 stfeco    0.437   0.385    0.344   0.0906 -0.105     0.270   0.727 </span>
<span class="co">#&gt; 8 agea      0.0334  0.0172   0.0136 -0.0589  0.000202 -0.0375  0.0166</span>
<span class="co">#&gt; 9 eisced   -0.0155 -0.0557   0.0506  0.170  -0.312     0.0728  0.0382</span>
<span class="co">#&gt; # ... with 2 more variables: agea &lt;dbl&gt;, eisced &lt;dbl&gt;</span></code></pre></div>
<p>It’s the same correlation coefficients but with the diagonal set to the quality of the estimates. But <strong>note</strong> that both the order of the variables <code>Quality</code> and the order of the variables in <code>ess7corr</code> should be the same! Otherwise we might confuse quality coefficients between variables.</p>
<p>We often want to calculate the Common Method Variance (CMV) of some of these variables because they share common methods such as likert scales, etc. The <code>sqpr</code> package makes this very easy using the <code>sqpr_cmv</code> function. Supply the same <code>sqp_data</code>, the <code>Quality</code> dataset and <code>sqp_cmv</code> estimates the CMV between the variables specified (here only two)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#subtract the cmv from the observed correlation</span>
corr_q2_cmv &lt;-
<span class="st">  </span><span class="kw">sqp_cmv</span>(<span class="dt">x =</span> corr_q2,
          <span class="dt">sqp_data =</span> Quality,
          stfeco, stflife)

corr_q2_cmv
<span class="co">#&gt; # A tibble: 9 x 10</span>
<span class="co">#&gt;   rowname  poltrst    serv systmrsp ppltrst   polintr stflife  stfeco</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 poltrst   0.913   0.422    0.600   0.188  -0.200     0.138   0.437 </span>
<span class="co">#&gt; 2 serv      0.422   0.748    0.315   0.112  -0.0239    0.181   0.385 </span>
<span class="co">#&gt; 3 systmrsp  0.600   0.315    0.841   0.180  -0.234     0.143   0.344 </span>
<span class="co">#&gt; 4 ppltrst   0.188   0.112    0.180   0.703  -0.199     0.147   0.0906</span>
<span class="co">#&gt; 5 polintr  -0.200  -0.0239  -0.234  -0.199   0.601    -0.0408 -0.105 </span>
<span class="co">#&gt; 6 stflife   0.138   0.181    0.143   0.147  -0.0408    0.657   0.203 </span>
<span class="co">#&gt; 7 stfeco    0.437   0.385    0.344   0.0906 -0.105     0.203   0.727 </span>
<span class="co">#&gt; 8 agea      0.0334  0.0172   0.0136 -0.0589  0.000202 -0.0375  0.0166</span>
<span class="co">#&gt; 9 eisced   -0.0155 -0.0557   0.0506  0.170  -0.312     0.0728  0.0382</span>
<span class="co">#&gt; # ... with 2 more variables: agea &lt;dbl&gt;, eisced &lt;dbl&gt;</span></code></pre></div>
<p>Perhaps you can’t see it but the coefficient of the <code>stfeco</code> and <code>stflife</code> combination has gone down from <code>0.27</code> to <code>0.20</code>. More concretely, <code>sqp_cmv</code> calculates the CMV and subtracts it from the correlation coefficient. A more directly example is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cmv &lt;-
<span class="st">  </span>Quality <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(question <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;stflife&quot;</span>, <span class="st">&quot;stfeco&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>sqpr<span class="op">:::</span><span class="kw">estimate_cmv</span>()

<span class="fl">0.27</span> <span class="op">-</span><span class="st"> </span>cmv
<span class="co">#&gt; [1] 0.2029138</span></code></pre></div>
<p>However, I don’t advise any user to use <code>sqpr:::estimate_cmv</code> because it has not been developed for public use. The ready-for use version is <code>sqp_cmv</code>.</p>
<p>To finish off correcting for the measurement error, we need to turn that correlation matrix into a covariance matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corrected_corr &lt;-<span class="st"> </span>corr_q2_cmv <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>rowname) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov2cor</span>()

corrected_corr
<span class="co">#&gt;           poltrst        serv    systmrsp     ppltrst       polintr</span>
<span class="co">#&gt;  [1,]  1.00000000  0.51089817  0.68481184  0.23408069 -0.2696866313</span>
<span class="co">#&gt;  [2,]  0.51089817  1.00000000  0.39647636  0.15389686 -0.0356323296</span>
<span class="co">#&gt;  [3,]  0.68481184  0.39647636  1.00000000  0.23379129 -0.3291996309</span>
<span class="co">#&gt;  [4,]  0.23408069  0.15389686  0.23379129  1.00000000 -0.3057882631</span>
<span class="co">#&gt;  [5,] -0.26968663 -0.03563233 -0.32919963 -0.30578826  1.0000000000</span>
<span class="co">#&gt;  [6,]  0.17826853  0.25822558  0.19284019  0.21658529 -0.0648521773</span>
<span class="co">#&gt;  [7,]  0.53605746  0.52189944  0.43978136  0.12669684 -0.1589191383</span>
<span class="co">#&gt;  [8,]  0.03498651  0.01992584  0.01488253 -0.07022916  0.0002606033</span>
<span class="co">#&gt;  [9,] -0.01677901 -0.06673867  0.05724204  0.21013928 -0.4179382317</span>
<span class="co">#&gt;           stflife      stfeco          agea      eisced</span>
<span class="co">#&gt;  [1,]  0.17826853  0.53605746  0.0349865071 -0.01677901</span>
<span class="co">#&gt;  [2,]  0.25822558  0.52189944  0.0199258389 -0.06673867</span>
<span class="co">#&gt;  [3,]  0.19284019  0.43978136  0.0148825271  0.05724204</span>
<span class="co">#&gt;  [4,]  0.21658529  0.12669684 -0.0702291629  0.21013928</span>
<span class="co">#&gt;  [5,] -0.06485218 -0.15891914  0.0002606033 -0.41793823</span>
<span class="co">#&gt;  [6,]  1.00000000  0.29364211 -0.0463192577  0.09308766</span>
<span class="co">#&gt;  [7,]  0.29364211  1.00000000  0.0194688586  0.04639888</span>
<span class="co">#&gt;  [8,] -0.04631926  0.01946886  1.0000000000 -0.23387395</span>
<span class="co">#&gt;  [9,]  0.09308766  0.04639888 -0.2338739464  1.00000000</span></code></pre></div>
<p>Here we have a corrected matrix for both measurement error and for the common method variance of some variables. We can dump this into our <code>sem</code> models and get much better estimates.</p>
</div>
<div id="regression-model" class="section level2">
<h2>Regression model</h2>
<p>Let’s run two arbitrary regression models and see how the results differ.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model&lt;-<span class="st"> &quot;poltrst ~ ppltrst + stflife + polintr + stfeco + serv + systmrsp + agea + eisced&quot;</span>

<span class="co"># Model based on original correlation matrix</span>
fit &lt;-
<span class="st">  </span><span class="kw">sem</span>(model,
      <span class="dt">sample.cov=</span>original_corr_<span class="dv">2</span>,
      <span class="dt">sample.nobs=</span> <span class="dv">1624</span>) 

<span class="co"># Model based on corrected correlation matrix </span>
fit.corrected &lt;-
<span class="st">  </span><span class="kw">sem</span>(model,
      <span class="dt">sample.cov=</span>corrected_corr,
      <span class="dt">sample.nobs=</span> <span class="dv">1624</span>) </code></pre></div>
<p>Let’s look at how much the coefficients differ</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coef_table &lt;-
<span class="st">  </span><span class="kw">list</span>(fit, fit.corrected) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">map</span>(parameterestimates) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span><span class="kw">filter</span>(.x, lhs <span class="op">==</span><span class="st"> &quot;poltrst&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span><span class="kw">select</span>(.x, rhs, est, ci.lower, ci.upper)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;original&quot;</span>, <span class="st">&quot;corrected&quot;</span>), <span class="dt">each =</span> <span class="dv">9</span>))

coef_table <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(rhs, est, <span class="dt">colour =</span> model)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> ci.lower, <span class="dt">ymax =</span> ci.upper), <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Predictors&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Estimated coefficients&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It differs slightly between models (although strongly for the dependent variable). Another approach is getting the ratio between the corrected over the original model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Relative increase (they don't only go up!):</span>
<span class="kw">coef</span>(fit.corrected) <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(fit)
<span class="co">#&gt;  poltrst~ppltrst  poltrst~stflife  poltrst~polintr   poltrst~stfeco </span>
<span class="co">#&gt;            0.947            1.689            1.160            1.053 </span>
<span class="co">#&gt;     poltrst~serv poltrst~systmrsp     poltrst~agea   poltrst~eisced </span>
<span class="co">#&gt;            1.028            1.076            0.207            1.310 </span>
<span class="co">#&gt; poltrst~~poltrst </span>
<span class="co">#&gt;            0.786</span></code></pre></div>
<p>It looks like the results do differ substantially! Otherwise everything would be at <code>1</code>.</p>
<p>Moreover, the R-squares of the models differ quite substantially.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R2_uncorr &lt;-<span class="st"> </span><span class="kw">inspect</span>(fit, <span class="st">'r2'</span>)
R2 &lt;-<span class="st"> </span><span class="kw">inspect</span>(fit.corrected, <span class="st">'r2'</span>)

<span class="co"># Change of R2:</span>
R2 <span class="op">-</span><span class="st"> </span>R2_uncorr
<span class="co">#&gt; poltrst </span>
<span class="co">#&gt;   0.114</span></code></pre></div>
<p>This case-study shows how adjusting for measurement error and Common Method Variance (CMV) can improve your estimates. We hope that you find the <code>sqpr</code> package useful for your estimations.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
